include required("/stdlib/jdk/24/openjdk.conf")
include required("https://raw.githubusercontent.com/hydraulic-software/conveyor/master/configs/jvm/extract-native-libraries.conf")

app {
  fsname = vaadin-conveyor
  display-name = "Vaadin Conveyor POC"
  rdns-name = "dev.nathanlively.vaadin-conveyor"
  version = 1.0.0
  // For iteration speed. Remove for release.
  compression-level = low
  site.base-url = "localhost:3000"
  inputs += "target/vaadin-conveyor-1.0-SNAPSHOT.jar"
  jvm {
    gui = "org.springframework.boot.loader.launch.JarLauncher"
    options += "-Xmx512m"
    options += "-Dserver.port=0"  // Use random available port to avoid conflicts
    modules += jdk.zipfs
    modules += java.management
    modules += java.management.rmi
    modules += java.naming
    modules += java.sql
    modules += java.security.jgss  // Required for GSSAPI/Kerberos support
    modules += java.desktop        // Required for Desktop.browse() functionality
    modules += java.instrument     // Required for Spring Boot instrumentation
    modules += java.compiler       // Often needed for Spring Boot's runtime compilation
    modules += jdk.unsupported     // Sometimes needed for low-level operations
  }

  machines = [ "mac", "windows.amd64", "linux.amd64.glibc", "linux.aarch64.glibc" ]
}

conveyor.compatibility-level = 19